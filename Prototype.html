<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPI Survey Platform</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #1a56db 0%, #3b82f6 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 8px 8px 0 0;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1a56db;
            font-size: 20px;
        }

        .logo img {
            width: 80%;
            height: auto;
        }
        .logo svg {
            width: 80%;
            height: auto;
            display: block;
        }
        
        .logo-text {
            font-weight: bold;
            font-size: 1.5rem;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 20px;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 12px;
            border-radius: 4px;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        nav a:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        /* Highlight active nav item */
        nav a.nav-active {
            background-color: rgba(255, 255, 255, 0.3);
            font-weight: 700;
        }
        
        .main-content {
            background-color: white;
            padding: 25px;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            min-height: 500px;
        }
        
        .page {
            display: none;
        }
        
        .active {
            display: block;
        }
        
        h2 {
            color: #1e40af;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        h2 i {
            color: #3b82f6;
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .stat-card h3 {
            font-size: 2rem;
            margin-bottom: 5px;
        }
        
        .btn {
            display: inline-block;
            background-color: #3b82f6;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        /* Center content for the Login button */
        #login-btn {
            justify-content: center;
        }
        
        .btn:hover {
            background-color: #2563eb;
        }
        
        .btn-secondary {
            background-color: #9ca3af;
        }
        
        .btn-secondary:hover {
            background-color: #6b7280;
        }
        
        .btn-success {
            background-color: #10b981;
        }
        
        .btn-success:hover {
            background-color: #059669;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .form-section {
            background-color: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            border-left: 4px solid #3b82f6;
            position: relative;
        }
        
        .form-section h3 {
            color: #1e40af;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-section h3 i {
            color: #3b82f6;
        }
        
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .history-table th, .history-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .history-table th {
            background-color: #f3f4f6;
            color: #374151;
            font-weight: 600;
        }
        
        .history-table tr:hover {
            background-color: #f9fafb;
        }
        
        /* Horizontal scroll for wide tables */
        .table-scroll {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .table-scroll .history-table {
            min-width: 1600px;
            white-space: nowrap;
        }
        
        .login-container {
            max-width: 400px;
            margin: 50px auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .success-container {
            text-align: center;
            padding: 40px 0;
        }
        
        .success-icon {
            font-size: 5rem;
            color: #10b981;
            margin-bottom: 20px;
        }
        
        .repeater-item {
            background-color: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #e5e7eb;
            position: relative;
        }
        
        .remove-item {
            position: absolute;
            top: 10px;
            right: 10px;
            color: #ef4444;
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .checkbox-group input {
            width: auto;
            margin-right: 10px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        /* Form grid utilities */
        .form-columns { display: grid; gap: 20px; }
        .form-columns.cols-1 { grid-template-columns: 1fr; }
        .form-columns.cols-2 { grid-template-columns: 1fr 1fr; }
        .form-columns.cols-3 { grid-template-columns: 1fr 1fr 1fr; }
        .form-columns.cols-4 { grid-template-columns: 1fr 1fr 1fr 1fr; }
        
        .full-width {
            grid-column: 1 / -1; /* spans across all columns */
        }
        
        .quarter-year-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
            background-color: #f0f4ff;
            padding: 15px;
            border-radius: 8px;
        }
        
        .variation-container {
            margin-top: 15px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        
        .input-with-icon {
            position: relative;
        }
        
        .input-with-icon > i,
        .input-with-icon > .material-symbols-outlined {
            position: absolute;
            left: 12px;
            top: 42px;
            color: #6b7280;
        }

        .input-with-icon.search-icon > i,
        .input-with-icon.search-icon > .material-symbols-outlined {
            top: 16px;
        }
        
        .input-with-icon input, .input-with-icon select {
            padding-left: 40px;
        }

        /* Password visibility toggle */
        .input-with-icon.has-toggle input {
            padding-right: 40px;
        }
        .input-with-icon .password-toggle {
            position: absolute;
            right: 12px;
            top: 42px;
            color: #6b7280;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
        }

        /* Align the eye icon inside the toggle button */
        .input-with-icon .password-toggle i,
        .input-with-icon .password-toggle .material-symbols-outlined {
            display: inline-block;
            line-height: 1;
        }

        /* Vertically center icons with text inside buttons and nav links */
        .btn i,
        .btn .material-symbols-outlined,
        nav a i,
        nav a .material-symbols-outlined {
            line-height: 1;
            vertical-align: middle;
            font-size: 20px;
        }
        
        .section-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            color: #3b82f6;
            font-size: 1.5rem;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 10px;
        }
        
        .pagination button {
            padding: 8px 16px;
            background-color: #3b82f6;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .pagination button:hover {
            background-color: #2563eb;
        }
        
        .pagination button.active {
            background-color: #1e40af;
        }
        
        @media (max-width: 768px) {
            .form-columns { grid-template-columns: 1fr; }
            
            .full-width {
                grid-column: 1;
            }
            
            .quarter-year-selector {
                grid-template-columns: 1fr;
            }
            
            nav ul {
                flex-wrap: wrap;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo" aria-label="FCSC Logo">
                    <svg viewBox="0 0 101 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M0.706909 0V100H100.707V0H0.706909ZM98.0237 97.3168H3.39009V2.68318H98.0237V97.3168Z" fill="white"/>
                        <path d="M89.9742 10.7327H72.1207V89.2672H89.9742V10.7327Z" fill="white"/>
                        <path d="M54.2672 10.7327H11.4396V28.5861H36.4138C44.5665 25.3869 51.0681 18.8854 54.2672 10.7327Z" fill="white"/>
                        <path d="M50.6554 42.8276H36.4139C27.4356 56.6563 21.2436 72.3426 18.5604 89.2673H50.6554V42.8276Z" fill="white"/>
                        </svg>                        
                </div>
                <div class="logo-text">IPI Survey Platform</div>
            </div>
            <nav>
                <ul>
                    <li><a href="#" id="nav-landing"><i class="fas fa-home"></i> Dashboard</a></li>
                    <li><a href="#" id="nav-profile"><i class="fas fa-user"></i> Profile</a></li>
                    <li><a href="#" id="nav-production"><i class="fas fa-industry"></i> Production</a></li>
                    <li><a href="#" id="nav-history"><i class="fas fa-history"></i> History</a></li>
                    <li><a href="#" id="nav-logout"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
                </ul>
            </nav>
        </header>

        <div class="main-content">
            <!-- Login Page -->
            <div id="login-page" class="page active">
                <div class="login-container">
                    <div class="login-header">
                        <h2><i class="fas fa-chart-line"></i> IPI Survey Platform</h2>
                        <p>Sign in to your account</p>
                    </div>
                    <form id="login-form">
                        <div class="form-group input-with-icon">
                            <label for="username">Username</label>
                            <i class="fas fa-user"></i>
                            <input type="text" id="username" placeholder="Enter your username" required>
                        </div>
                        <div class="form-group input-with-icon has-toggle">
                            <label for="password">Password</label>
                            <i class="fas fa-lock"></i>
                            <input type="password" id="password" placeholder="Enter your password" required>
                            <button type="button" class="password-toggle" aria-label="Show password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div style="text-align: right; margin-top: -10px; margin-bottom: 15px;">
                            <a href="#" id="forgot-password" style=" text-decoration: underline; font-size: 0.9rem;">Forgot password?</a>
                        </div>
                        <button type="button" id="login-btn" class="btn" style="width: 100%;">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                    </form>
                </div>
            </div>

            <!-- Landing Page -->
            <div id="landing-page" class="page">
                <h2><i class="fas fa-home"></i> Dashboard Overview</h2>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <i class="fas fa-box"></i>
                        <h3>142</h3>
                        <p>Products Registered</p>
                    </div>
                    <div class="stat-card">
                        <span class="material-symbols-outlined">warehouse</span>
                        <h3>5</h3>
                        <p>Production Locations</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-file-alt"></i>
                        <h3>Q2 2023</h3>
                        <p>Latest Report</p>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <button id="add-data-btn" class="btn"><i class="fas fa-plus"></i> Add New Data</button>
                    <button id="view-history-btn" class="btn"><i class="fas fa-history"></i> View Full History</button>
                </div>
                
                <h3><i class="fas fa-history"></i> Recent Submissions</h3>
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Quarter</th>
                            <th>Products</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>15 Jul 2025</td>
                            <td>Q2 2025</td>
                            <td>8 products</td>
                            <td>Approved</td>
                        </tr>
                        <tr>
                            <td>15 Apr 2025</td>
                            <td>Q1 2025</td>
                            <td>7 products</td>
                            <td>Approved</td>
                        </tr>
                        <tr>
                            <td>15 Jan 2025</td>
                            <td>Q4 2024</td>
                            <td>6 products</td>
                            <td>Approved</td>
                        </tr>
                        <tr>
                            <td>15 Oct 2024</td>
                            <td>Q3 2024</td>
                            <td>5 products</td>
                            <td>Approved</td>
                        </tr>
                        <tr>
                            <td>15 Jul 2024</td>
                            <td>Q2 2024</td>
                            <td>4 products</td>
                            <td>Approved</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Profile Page -->
            <div id="profile-page" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #e5e7eb;">
                    <h2 style="margin: 0;"><i class="fas fa-user"></i> Company Profile</h2>
                    <button type="button" id="change-password" class="btn btn-primary"><span class="material-symbols-outlined">password</span> Change Password</button>
                </div>
                
                <div class="form-section">
                    <i class="fas fa-address-card section-icon"></i>
                    <h3><i class="fas fa-info-circle"></i> Identification Particulars</h3>
                    <div class="form-columns cols-2">
                        <div class="form-group input-with-icon">
                            <label for="factory-code">Permanent Factory Code</label>
                            <i class="fas fa-building"></i>
                            <input type="text" id="factory-code">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="license-number">Unique License Number</label>
                            <i class="fas fa-id-card"></i>
                            <input type="text" id="license-number">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="industry-code">Industry Code (Business Register)</label>
                            <i class="fas fa-hashtag"></i>
                            <input type="text" id="industry-code" placeholder="4-digit ISIC-4">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="production-code">Industry Code (Current Production)</label>
                            <i class="fas fa-hashtag"></i>
                            <input type="text" id="production-code" placeholder="4-digit ISIC-4">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="industry-desc">Description of Industry</label>
                            <i class="fas fa-align-left"></i>
                            <textarea id="industry-desc" rows="3"></textarea>
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="reference-year">Reference Year of the Data</label>
                            <i class="fas fa-calendar"></i>
                            <input type="number" id="reference-year" min="2020" max="2030" value="2025">
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <i class="fas fa-address-book section-icon"></i>
                    <h3><i class="fas fa-map-marker-alt"></i> Establishment Contact Details</h3>
                    <div class="form-columns cols-2">
                        <div class="form-group input-with-icon">
                            <label for="factory-name-ar">Name & Address (Arabic)</label>
                            <i class="fas fa-font"></i>
                            <input type="text" id="factory-name-ar">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="factory-name-en">Name & Address (English)</label>
                            <i class="fas fa-font"></i>
                            <input type="text" id="factory-name-en">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="city">City/Town</label>
                            <i class="fas fa-city"></i>
                            <input type="text" id="city">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="emirate">Emirate</label>
                            <i class="fas fa-map"></i>
                            <select id="emirate">
                                <option value="">Select Emirate</option>
                                <option value="abu-dhabi">Abu Dhabi</option>
                                <option value="dubai">Dubai</option>
                                <option value="sharjah">Sharjah</option>
                                <option value="ajman">Ajman</option>
                                <option value="umm-al-quwain">Umm Al Quwain</option>
                                <option value="ras-al-khaimah">Ras Al Khaimah</option>
                                <option value="fujairah">Fujairah</option>
                            </select>
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="postal-code">Postal Code/PO Box</label>
                            <i class="fas fa-envelope"></i>
                            <input type="text" id="postal-code">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="makani">Makani Number</label>
                            <i class="fas fa-map-pin"></i>
                            <input type="text" id="makani">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="contact-person">Contact Person Name & Designation</label>
                            <i class="fas fa-user-tie"></i>
                            <input type="text" id="contact-person">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="mobile">Mobile Number</label>
                            <i class="fas fa-mobile-alt"></i>
                            <input type="tel" id="mobile">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="email">Email</label>
                            <i class="fas fa-at"></i>
                            <input type="email" id="email">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="website">Website</label>
                            <i class="fas fa-globe"></i>
                            <input type="url" id="website">
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <i class="fas fa-building section-icon"></i>
                    <h3><span class="material-symbols-outlined">warehouse</span> Corporate/Head Office Contact Details</h3>
                    <div class="checkbox-group">
                        <input type="checkbox" id="same-as-establishment">
                        <label for="same-as-establishment">Same as Establishment Contact Details</label>
                    </div>
                    
                    <div id="corporate-details">
                        <div class="form-columns cols-2">
                            <div class="form-group input-with-icon">
                                <label for="corporate-name-ar">Name & Address (Arabic)</label>
                                <i class="fas fa-font"></i>
                                <input type="text" id="corporate-name-ar">
                            </div>
                            <div class="form-group input-with-icon">
                                <label for="corporate-name-en">Name & Address (English)</label>
                                <i class="fas fa-font"></i>
                                <input type="text" id="corporate-name-en">
                            </div>
                            <div class="form-group input-with-icon">
                                <label for="corporate-city">City/Town</label>
                                <i class="fas fa-city"></i>
                                <input type="text" id="corporate-city">
                            </div>
                            <div class="form-group input-with-icon">
                                <label for="corporate-emirate">Emirate</label>
                                <i class="fas fa-map"></i>
                                <select id="corporate-emirate">
                                    <option value="">Select Emirate</option>
                                    <option value="abu-dhabi">Abu Dhabi</option>
                                    <option value="dubai">Dubai</option>
                                    <option value="sharjah">Sharjah</option>
                                    <option value="ajman">Ajman</option>
                                    <option value="umm-al-quwain">Umm Al Quwain</option>
                                    <option value="ras-al-khaimah">Ras Al Khaimah</option>
                                    <option value="fujairah">Fujairah</option>
                                </select>
                            </div>
                            <div class="form-group input-with-icon">
                                <label for="corporate-postal">Postal Code/PO Box</label>
                                <i class="fas fa-envelope"></i>
                                <input type="text" id="corporate-postal">
                            </div>
                            <div class="form-group input-with-icon">
                                <label for="contact-person">Contact Person Name & Designation</label>
                                <i class="fas fa-user-tie"></i>
                                <input type="text" id="contact-person">
                            </div>
                        </div>
                        <div class="form-columns cols-3">
                            <div class="form-group input-with-icon">
                                <label for="mobile">Mobile Number</label>
                                <i class="fas fa-mobile-alt"></i>
                                <input type="tel" id="mobile">
                            </div>
                            <div class="form-group input-with-icon">
                                <label for="email">Email</label>
                                <i class="fas fa-at"></i>
                                <input type="email" id="email">
                            </div>
                            <div class="form-group input-with-icon">
                                <label for="website">Website</label>
                                <i class="fas fa-globe"></i>
                                <input type="url" id="website">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <i class="fas fa-address-card section-icon"></i>
                    <h3><span class="material-symbols-outlined">groups</span> Employment in Establishment</h3>
                    <div class="form-columns cols-4">
                        <div class="form-group input-with-icon">
                            <label for="employment-emirati-male">Emirati Male</label>
                            <i class="fas fa-male"></i>
                            <input type="number" id="employment-emirati-male" min="0" value="0">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="employment-non-emirati-male">Non-Emirati Male</label>
                            <i class="fas fa-male"></i>
                            <input type="number" id="employment-non-emirati-male" min="0" value="0">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="employment-emirati-female">Emirati Female</label>
                            <i class="fas fa-female"></i>
                            <input type="number" id="employment-emirati-female" min="0" value="0">
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="employment-non-emirati-female">Non-Emirati Female</label>
                            <i class="fas fa-female"></i>
                            <input type="number" id="employment-non-emirati-female" min="0" value="0">
                        </div>
                    </div>
                    <div class="form-columns cols-2">
                        <div class="form-group input-with-icon">
                            <label for="employment-total">Total Employees</label>
                            <i class="fas fa-users"></i>
                            <input type="number" id="employment-total" readonly>
                        </div>
                        <div class="form-group input-with-icon">
                            <label for="employment-emirati-total">Total Emirati</label>
                            <i class="fas fa-users"></i>
                            <input type="number" id="employment-emirati-total" readonly>
                        </div>
                    </div>
                </div>
                <button type="button" id="save-profile" class="btn"><i class="fas fa-save"></i> Save Profile</button>

            </div>

            <!-- Production Page -->
            <div id="production-page" class="page">
                <h2><i class="fas fa-industry"></i> Production Data</h2>
                
                <div class="quarter-year-selector">
                    <div class="form-group input-with-icon">
                        <label for="quarter">Quarter</label>
                        <i class="fas fa-calendar-alt"></i>
                        <select id="quarter" required>
                            <option value="">Select Quarter</option>
                            <option value="Q1">Q1</option>
                            <option value="Q2">Q2</option>
                            <option value="Q3">Q3</option>
                            <option value="Q4">Q4</option>
                        </select>
                    </div>
                    <div class="form-group input-with-icon">
                        <label for="year">Year</label>
                        <i class="fas fa-calendar"></i>
                        <select id="year" required>
                            <option value="">Select Year</option>
                            <option value="2023">2023</option>
                            <option value="2024">2024</option>
                            <option value="2025" selected>2025</option>
                        </select>
                    </div>
                </div>
                
                <div id="product-repeater">
                    <div class="repeater-item">
                        <button class="remove-item"><i class="fas fa-trash"></i></button>
                        
                        <h3><i class="fas fa-cube"></i> Product #1</h3>
                        
                        <div class="form-columns  cols-2">
                            <div class="form-group input-with-icon">
                                <label>HS Code</label>
                                <i class="fas fa-barcode"></i>
                                <input type="text" class="hs-code" list="hs-codes" placeholder="Start typing HS code">
                            </div>
                            <div class="form-group input-with-icon">
                                <label>Product Name</label>
                                <i class="fas fa-tag"></i>
                                <input type="text" class="product-name" readonly>
                            </div>
                            <div class="form-group input-with-icon">
                                <label>Unit of Quantity</label>
                                <i class="fas fa-box"></i>
                                <input type="text">
                            </div>
                            <div class="form-group input-with-icon">
                                <label>Annual Installed Capacity (in Unit of Quantity)</label>
                                <i class="fas fa-box"></i>
                                <input type="number">
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <i class="fas fa-boxes section-icon"></i>
                            <h3><i class="fas fa-cogs"></i> Production</h3>
                            <h4><i class="fas fa-calendar-check"></i> During this Quarter</h4>
                            
                            <div class="form-columns cols-2">
                                <div class="form-group input-with-icon">
                                    <label>Quantity in its Unit</label>
                                    <i class="fas fa-box"></i>
                                    <input type="number" class="current-qty">
                                </div>
                                <div class="form-group input-with-icon">
                                    <label>Cost at producer level (in AED)</label>
                                    <i class="fas fa-money-bill-wave"></i>
                                    <input type="number">
                                </div>
                                <div class="form-group full-width input-with-icon">
                                    <label>Quantity produced since January of the reference year until this quarter (in Unit of Quantity)</label>
                                    <i class="fas fa-boxes"></i>
                                    <input type="number">
                                </div>
                            </div>
                            
                            <h4><i class="fas fa-calendar-minus"></i> Previous Quarter</h4>
                            
                            <div class="form-columns cols-2">
                                <div class="form-group input-with-icon">
                                    <label>Quantity in its Unit</label>
                                    <i class="fas fa-box"></i>
                                    <input type="number" class="previous-qty">
                                </div>
                                <div class="form-group input-with-icon">
                                    <label>Cost at producer level (in AED)</label>
                                    <i class="fas fa-money-bill-wave"></i>
                                    <input type="number">
                                </div>
                            </div>
                            
                            <div class="variation-container">
                                <div class="form-group">
                                    <label>Major reason for variation</label>
                                    <select class="variation-reason" disabled>
                                        <option value="">Enter both quantities to enable</option>
                                    </select>
                                </div>
                                <div class="form-group full-width">
                                    <label>Remarks</label>
                                    <textarea rows="3" placeholder="Add any additional remarks here"></textarea>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <i class="fas fa-bullseye section-icon"></i>
                            <h3><i class="fas fa-chart-line"></i> Expected Target Production</h3>
                            
                            <div class="form-columns cols-3">
                                <div class="form-group input-with-icon">
                                    <label>Next quarter Quantity in its Unit</label>
                                    <i class="fas fa-box"></i>
                                    <input type="number">
                                </div>
                                <div class="form-group input-with-icon">
                                    <label>Next quarter cost at producer level in AED</label>
                                    <i class="fas fa-money-bill-wave"></i>
                                    <input type="number">
                                </div>
                                <div class="form-group input-with-icon">
                                    <label>Major reason for 0 expected target</label>
                                    <i class="fas fa-exclamation-triangle"></i>
                                    <select>
                                        <option value="">Select reason</option>
                                        <option value="01">01 - Units are manufacturing seasonal items</option>
                                        <option value="02">02 - Plant under maintenance</option>
                                        <option value="03">03 - Non completion of production of machinery in a particular month</option>
                                        <option value="04">04 - Factory can’t disclose the production figures prior to</option>
                                        <option value="05">05 - Unit hasn’t received any orders for the next month</option>
                                        <option value="06">06 - Production is completely dependent on order</option>
                                        <option value="07">07 - Units to not disclose their data without final approval</option>
                                        <option value="08">08 - Temporary closed</option>
                                        <option value="09">09 - Production suspended for a particular item</option>
                                        <option value="10">10 - Labor strike</option>
                                        <option value="11">11 - Natural calamity</option>
                                        <option value="12">12 - Others (Please specify)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button id="add-product" class="btn"><i class="fas fa-plus"></i> Add Another Product</button>
                
                <div style="margin-top: 30px;">
                    <button id="submit-production" class="btn btn-success"><i class="fas fa-check"></i> Submit Production Data</button>
                    <button id="cancel-production" class="btn btn-secondary"><i class="fas fa-times"></i> Cancel</button>
                </div>
            </div>

            <!-- Submission History Page -->
            <div id="history-page" class="page">
                <h2><i class="fas fa-history"></i> Submission History</h2>
                
                <div class="form-group" style="max-width: 300px;">
                    <label for="history-search">Search</label>
                    <div class="input-with-icon search-icon">
                        <i class="fas fa-search"></i>
                        <input type="text" id="history-search" placeholder="Search submissions...">
                    </div>
                </div>
                
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Quarter</th>
                            <th>Products</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>15 Jul 2025</td>
                            <td>Q2 2025</td>
                            <td>8 products</td>
                            <td>Approved</td>
                            <td><button class="btn"><i class="fas fa-eye"></i> View</button></td>
                        </tr>
                        <tr>
                            <td>15 Apr 2025</td>
                            <td>Q1 2025</td>
                            <td>7 products</td>
                            <td>Approved</td>
                            <td><button class="btn"><i class="fas fa-eye"></i> View</button></td>
                        </tr>
                        <tr>
                            <td>15 Jan 2025</td>
                            <td>Q4 2024</td>
                            <td>6 products</td>
                            <td>Approved</td>
                            <td><button class="btn"><i class="fas fa-eye"></i> View</button></td>
                        </tr>
                        <tr>
                            <td>15 Oct 2024</td>
                            <td>Q3 2024</td>
                            <td>5 products</td>
                            <td>Approved</td>
                            <td><button class="btn"><i class="fas fa-eye"></i> View</button></td>
                        </tr>
                        <tr>
                            <td>15 Jul 2024</td>
                            <td>Q2 2024</td>
                            <td>4 products</td>
                            <td>Approved</td>
                            <td><button class="btn"><i class="fas fa-eye"></i> View</button></td>
                        </tr>
                        <tr>
                            <td>15 Apr 2024</td>
                            <td>Q1 2024</td>
                            <td>3 products</td>
                            <td>Approved</td>
                            <td><button class="btn"><i class="fas fa-eye"></i> View</button></td>
                        </tr>
                        <tr>
                            <td>15 Jan 2024</td>
                            <td>Q4 2023</td>
                            <td>2 products</td>
                            <td>Approved</td>
                            <td><button class="btn"><i class="fas fa-eye"></i> View</button></td>
                        </tr>
                        <tr>
                            <td>15 Oct 2023</td>
                            <td>Q3 2023</td>
                            <td>1 product</td>
                            <td>Approved</td>
                            <td><button class="btn"><i class="fas fa-eye"></i> View</button></td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="pagination">
                    <button class="active">1</button>
                    <button>2</button>
                    <button>3</button>
                    <button>Next <i class="fas fa-chevron-right"></i></button>
                </div>
            </div>

            <!-- History Details (Read-only) Page -->
            <div id="history-details-page" class="page">
                <h2><i class="fas fa-eye"></i> Submission Details</h2>
                <div class="form-section">
                    <h3><i class="fas fa-file-alt"></i> Summary</h3>
                    <div class="form-columns cols-3">
                        <div class="form-group input-with-icon">
                            <label>Submission Date</label>
                            <i class="fas fa-calendar"></i>
                            <input type="text" value="15 Jul 2025" readonly>
                        </div>
                        <div class="form-group input-with-icon">
                            <label>Quarter</label>
                            <i class="fas fa-calendar-alt"></i>
                            <input type="text" value="Q2 2025" readonly>
                        </div>
                        <div class="form-group input-with-icon">
                            <label>Status</label>
                            <i class="fas fa-check"></i>
                            <input type="text" value="Approved" readonly>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <h3><i class="fas fa-boxes"></i> Products</h3>
                    <div class="table-scroll">
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>HS Code</th>
                                <th>Product Name</th>
                                <th>Unit of Quantity</th>
                                <th>Annual Installed Capacity (Unit)</th>
                                <th>Current Quarter: Qty</th>
                                <th>Current Quarter: Cost (AED)</th>
                                <th>YTD Qty (Jan to this Qtr)</th>
                                <th>Previous Quarter: Qty</th>
                                <th>Previous Quarter: Cost (AED)</th>
                                <th>Variation Reason</th>
                                <th>Target Next Quarter: Qty</th>
                                <th>Target Next Quarter: Cost (AED)</th>
                                <th>Zero Target Reason</th>
                                <th>Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>1</td><td>02013000</td><td>Boneless</td><td>KG</td><td>2500</td><td>1200</td><td>36,000</td><td>3,400</td><td>1100</td><td>33,000</td><td>High demand</td><td>1250</td><td>37,500</td><td>-</td><td>-</td></tr>
                            <tr><td>2</td><td>02042100</td><td>Carcasses and Halfcarcasses</td><td>KG</td><td>1800</td><td>800</td><td>28,000</td><td>1,600</td><td>750</td><td>26,250</td><td>More order</td><td>820</td><td>29,520</td><td>-</td><td>-</td></tr>
                            <tr><td>3</td><td>03061700</td><td>Other Shrimps and Prawns</td><td>KG</td><td>900</td><td>500</td><td>22,000</td><td>1,020</td><td>520</td><td>21,840</td><td>Seasonal variation</td><td>480</td><td>20,000</td><td>-</td><td>Seasonal effect</td></tr>
                            <tr><td>4</td><td>04029110</td><td>Milk</td><td>L</td><td>5000</td><td>2000</td><td>14,000</td><td>8,200</td><td>1950</td><td>12,675</td><td>Change in capacity</td><td>2100</td><td>15,400</td><td>-</td><td>-</td></tr>
                            <tr><td>5</td><td>07134000</td><td>Lentils</td><td>KG</td><td>1500</td><td>650</td><td>9,750</td><td>1,280</td><td>600</td><td>9,000</td><td>High demand</td><td>670</td><td>10,050</td><td>-</td><td>-</td></tr>
                            <tr><td>6</td><td>08021200</td><td>Shelled</td><td>KG</td><td>1200</td><td>430</td><td>12,900</td><td>890</td><td>420</td><td>12,600</td><td>-</td><td>440</td><td>13,200</td><td>-</td><td>-</td></tr>
                            <tr><td>7</td><td>09041100</td><td>Neither Crushed nor Ground</td><td>KG</td><td>600</td><td>300</td><td>9,000</td><td>900</td><td>310</td><td>9,300</td><td>-</td><td>320</td><td>9,600</td><td>-</td><td>-</td></tr>
                            <tr><td>8</td><td>09041200</td><td>Crushed or Ground</td><td>KG</td><td>600</td><td>280</td><td>8,400</td><td>820</td><td>270</td><td>8,100</td><td>-</td><td>300</td><td>9,000</td><td>-</td><td>-</td></tr>
                        </tbody>
                    </table>
                    </div>
                </div>
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button id="history-back" class="btn"><i class="fas fa-history"></i> Back to History</button>
                    <button id="request-edit" class="btn btn-secondary"><i class="fas fa-edit"></i> Request Edit</button>
                </div>
            </div>

            <!-- Success Page -->
            <div id="success-page" class="page">
                <div class="success-container">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h2>Form Submitted Successfully!</h2>
                    <p>Your production data has been submitted successfully for processing.</p>
                    <p>You will receive a confirmation email shortly.</p>
                    
                    <div style="margin-top: 30px;">
                        <button id="back-to-dashboard" class="btn"><i class="fas fa-home"></i> Back to Dashboard</button>
                        <button id="view-submission" class="btn"><i class="fas fa-eye"></i> View Submission</button>
                    </div>
                </div>
            </div>
            
            <!-- Change Password Page -->
            <div id="change-password-page" class="page">
                <div class="login-container" style="max-width: 500px;">
                    <div class="login-header">
                        <h2><span class="material-symbols-outlined">password</span> Change Password</h2>
                        <p>Update your account password</p>
                    </div>
                    <form id="change-password-form">
                        <div class="form-group input-with-icon has-toggle">
                            <label for="current-password">Current Password</label>
                            <i class="fas fa-lock"></i>
                            <input type="password" id="current-password" required>
                            <button type="button" class="password-toggle" data-target="#current-password" aria-label="Show password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="form-group input-with-icon has-toggle">
                            <label for="new-password">New Password</label>
                            <i class="fas fa-lock"></i>
                            <input type="password" id="new-password" minlength="8" required>
                            <button type="button" class="password-toggle" data-target="#new-password" aria-label="Show password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <div class="form-group input-with-icon has-toggle">
                            <label for="confirm-password">Confirm New Password</label>
                            <i class="fas fa-lock"></i>
                            <input type="password" id="confirm-password" minlength="8" required>
                            <button type="button" class="password-toggle" data-target="#confirm-password" aria-label="Show password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <button type="submit" class="btn" style=" text-align:center;">
                            <span class="material-symbols-outlined">save</span> Submit
                        </button>
                        <div style="margin-top: 10px; text-align:center;">
                            <a href="#" id="cancel-change-password">Cancel and go back</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <footer>
            <p>Copyright © 2025 Federal Competitiveness and Statistics Centre, All Rights Reserved</p>
        </footer>
    </div>

    <!-- HS Code datalist -->
    <datalist id="hs-codes"></datalist>

    <script>
        // Reasons for variation data
        const highVariationReasons = [
            {code: "01", text: "High demand"},
            {code: "02", text: "Change in installed capacity"},
            {code: "03", text: "Merged with another unit"},
            {code: "04", text: "Variation due to different size/type of product"},
            {code: "05", text: "Seasonal variation"},
            {code: "06", text: "More order"},
            {code: "991", text: "Other (please specify)"}
        ];
        
        const lowVariationReasons = [
            {code: "07", text: "Low Demand"},
            {code: "08", text: "Manpower shortage"},
            {code: "09", text: "Financial issue"},
            {code: "10", text: "Non-availability of Raw Material"},
            {code: "11", text: "Procedural Delay"},
            {code: "12", text: "Temporarily Closed excluding Natural Calamity"},
            {code: "13", text: "Power"},
            {code: "14", text: "Machine Break Down"},
            {code: "15", text: "Change in Installed Capacity"},
            {code: "16", text: "Natural Calamity"},
            {code: "17", text: "Variation is due to different size/type of Product"},
            {code: "18", text: "Seasonal Variation"},
            {code: "19", text: "Merge in an another Unit"},
            {code: "20", text: "Less order"},
            {code: "21", text: "Other (please specify)"}
        ];

        $(document).ready(function() {
            // HS Code mapping (sample; extend as needed)
            const hsCodeToDesc = {
                "02013000": "Boneless",
                "02042100": "Carcasses and Halfcarcasses",
                "02071400": "Cuts and offal, Frozen",
                "02072700": "Cuts and offal, Frozen",
                "03061700": "Other Shrimps and Prawns",
                "04029110": "Milk",
                "04089100": "Dried",
                "05119990": "Animal products, n.e.s.",
                "07134000": "Lentils",
                "08021200": "Shelled",
                "09011100": "Not Decaffeinated",
                "09012100": "Not Decaffeinated",
                "09023010": "Tea Bags of A Content not Exceeding 3 G",
                "09024000": "Other Black Tea Fermented and Other Partly Fermented Tea",
                "09041100": "Neither Crushed nor Ground",
                "09041200": "Crushed or Ground",
                "09061100": "Cinnamon Cinnamomum Zeylanicum Blume",
                "09062000": "Crushed or Ground",
                "09103010": "Neither Crushed nor Ground"
            };
            const $hsDatalist = $("#hs-codes");
            $hsDatalist.empty();
            Object.entries(hsCodeToDesc).forEach(([code, desc]) => {
                $hsDatalist.append(`<option value="${code}">${desc}</option>`);
            });
            // Inline SVG used for logo (no external requests)
            // Replace Font Awesome icons with Material Symbols at runtime
            (function replaceFontAwesomeWithMaterial(){
                const mapping = {
                    'fa-home': 'home',
                    'fa-user': 'person',
                    'fa-industry': 'box',
                    'fa-history': 'history',
                    'fa-sign-out-alt': 'logout',
                    'fa-chart-line': 'show_chart',
                    'fa-lock': 'lock',
                    'fa-eye': 'visibility',
                    'fa-eye-slash': 'visibility_off',
                    'fa-sign-in-alt': 'login',
                    'fa-box': 'box',
                    'fa-file-alt': 'description',
                    'fa-save': 'save',
                    'fa-plus': 'add',
                    'fa-address-card': 'badge',
                    'fa-info-circle': 'info',
                    'fa-building': 'business',
                    'fa-id-card': 'badge',
                    'fa-hashtag': 'tag',
                    'fa-align-left': 'subject',
                    'fa-calendar': 'calendar_month',
                    'fa-map-marker-alt': 'location_on',
                    'fa-font': 'text_fields',
                    'fa-city': 'location_city',
                    'fa-map': 'map',
                    'fa-envelope': 'mail',
                    'fa-map-pin': 'place',
                    'fa-user-tie': 'work',
                    'fa-mobile-alt': 'smartphone',
                    'fa-at': 'alternate_email',
                    'fa-globe': 'public',
                    'fa-address-book': 'contacts',
                    'fa-calendar-alt': 'event',
                    'fa-times-circle': 'cancel',
                    'fa-trash': 'delete',
                    'fa-cube': 'category',
                    'fa-barcode': 'qr_code',
                    'fa-tag': 'sell',
                    'fa-boxes': 'inventory',
                    'fa-cogs': 'settings',
                    'fa-calendar-check': 'event_available',
                    'fa-money-bill-wave': 'payments',
                    'fa-calendar-minus': 'event_busy',
                    'fa-bullseye': 'track_changes',
                    'fa-exclamation-triangle': 'warning',
                    'fa-check-circle': 'check_circle',
                    'fa-check': 'check',
                    'fa-times': 'close',
                    'fa-chevron-right': 'chevron_right',
                    'fa-file-alt': 'description',
                    'fa-eye': 'visibility',
                    'fa-edit': 'edit',
                    'fa-search': 'search',
                    'fa-male': 'man',
                    'fa-female': 'woman',
                    'fa-users': 'badge'
                };
                $("i.fas").each(function(){
                    const $i = $(this);
                    const classes = ($i.attr('class') || '').split(/\s+/);
                    const faClass = classes.find(c => c.startsWith('fa-') && c !== 'fas');
                    const matName = faClass ? mapping[faClass] : undefined;
                    const extraClasses = classes.filter(c => c !== 'fas' && c !== faClass).join(' ');
                    if (matName) {
                        const $span = $('<span/>', { 'class': `material-symbols-outlined ${extraClasses}` }).text(matName);
                        $i.replaceWith($span);
                    }
                });
            })();
            // Navigation handlers
            $("#nav-landing").click(function(e) {
                e.preventDefault();
                showPage('landing-page');
            });
            
            $("#nav-profile").click(function(e) {
                e.preventDefault();
                showPage('profile-page');
            });
            
            $("#nav-production").click(function(e) {
                e.preventDefault();
                showPage('production-page');
            });
            
            $("#nav-history").click(function(e) {
                e.preventDefault();
                showPage('history-page');
            });
            
            $("#nav-logout").click(function(e) {
                e.preventDefault();
                showPage('login-page');
            });
            
            // Login handler
            $("#login-btn").click(function() {
                showPage('landing-page');
            });
            
            // Forgot password handler (placeholder)
            $("#forgot-password").click(function(e) {
                e.preventDefault();
                alert('Please contact the administrator to reset your password.');
            });
            
            // Add data button
            $("#add-data-btn").click(function() {
                showPage('production-page');
            });
            
            // View history button
            $("#view-history-btn").click(function() {
                showPage('history-page');
            });
            
            // Save profile button
            $("#save-profile").click(function() {
                alert("Profile saved successfully!");
                showPage('landing-page');
            });
            
            // Change Password navigation
            $("#change-password").click(function(){
                showPage('change-password-page');
            });
            
            // Same as establishment checkbox
            $("#same-as-establishment").change(function() {
                if(this.checked) {
                    $("#corporate-details").hide();
                } else {
                    $("#corporate-details").show();
                }
            });
            
            // Add product button
            $("#add-product").click(function() {
                var itemCount = $(".repeater-item").length + 1;
                var newItem = $(".repeater-item:first").clone();
                
                // Clear input values
                newItem.find('input, textarea, select').val('');
                newItem.find('.variation-reason').empty().append('<option value="">Enter both quantities to enable</option>').prop('disabled', true);
                
                // Update title
                newItem.find('h3').text('Product #' + itemCount);
                
                // Wire HS code change handler
                wireHsHandlers(newItem);
                
                // Add remove button functionality
                newItem.find(".remove-item").click(function() {
                    $(this).parent().remove();
                });
                
                // Add auto-calculation functionality
                newItem.find(".current-qty, .previous-qty").on('input', function() {
                    autoCalculateVariation($(this).closest('.repeater-item'));
                });
                
                $("#product-repeater").append(newItem);
            });
            
            // Remove item button
            $(".remove-item").click(function() {
                // Don't remove if it's the only item
                if($(".repeater-item").length > 1) {
                    $(this).parent().remove();
                } else {
                    alert("You need to have at least one product.");
                }
            });
            
            // Auto calculation for variation
            $(".current-qty, .previous-qty").on('input', function() {
                autoCalculateVariation($(this).closest('.repeater-item'));
            });
            
            // Employment totals auto-calc
            function updateEmploymentTotal() {
                const emiratiMale = parseInt($("#employment-emirati-male").val(), 10) || 0;
                const nonEmiratiMale = parseInt($("#employment-non-emirati-male").val(), 10) || 0;
                const emiratiFemale = parseInt($("#employment-emirati-female").val(), 10) || 0;
                const nonEmiratiFemale = parseInt($("#employment-non-emirati-female").val(), 10) || 0;
                
                const totalEmployees = emiratiMale + nonEmiratiMale + emiratiFemale + nonEmiratiFemale;
                const totalEmirati = emiratiMale + emiratiFemale;
                
                $("#employment-total").val(totalEmployees);
                $("#employment-emirati-total").val(totalEmirati);
            }
            $(document).on('input', '#employment-emirati-male, #employment-non-emirati-male, #employment-emirati-female, #employment-non-emirati-female', updateEmploymentTotal);
            updateEmploymentTotal();
            
            // Wire HS handler for the first product
            wireHsHandlers($(".repeater-item:first"));
            
            // Submit production button
            $("#submit-production").click(function() {
                // Validate quarter and year selection
                if ($("#quarter").val() === "" || $("#year").val() === "") {
                    alert("Please select both Quarter and Year before submitting.");
                    return;
                }
                
                showPage('success-page');
            });
            
            // Cancel production button
            $("#cancel-production").click(function() {
                showPage('landing-page');
            });
            
            // Back to dashboard button
            $("#back-to-dashboard").click(function() {
                showPage('landing-page');
            });
            
            // View submission button
            $("#view-submission").click(function() {
                showPage('history-page');
            });
            
            // History: View submission details
            $(document).on('click', '#history-page .history-table .btn', function() {
                showPage('history-details-page');
            });
            
            // History details: Back and Request Edit
            $(document).on('click', '#history-back', function() {
                showPage('history-page');
            });
            $(document).on('click', '#request-edit', function() {
                alert('Your edit request is under process. Once approved by admin, you will be notified by email and then you may update the records.');
            });
            
            // Change Password: toggle visibility per field
            $(document).on('click', '#change-password-form .password-toggle', function() {
                const targetSelector = $(this).data('target');
                const $input = $(targetSelector);
                const isPassword = $input.attr('type') === 'password';
                $input.attr('type', isPassword ? 'text' : 'password');
                const $icon = $(this).find('.material-symbols-outlined');
                if ($icon.length) {
                    $icon.text(isPassword ? 'visibility_off' : 'visibility');
                }
                $(this).attr('aria-label', isPassword ? 'Hide password' : 'Show password');
            });
            
            // Change Password: submit handler
            $(document).on('submit', '#change-password-form', function(e) {
                e.preventDefault();
                const newPwd = $('#new-password').val();
                const confirmPwd = $('#confirm-password').val();
                if (newPwd !== confirmPwd) {
                    alert('New password and confirm password do not match.');
                    return;
                }
                alert('Password changed successfully.');
                showPage('profile-page');
            });
            
            // Cancel change password
            $(document).on('click', '#cancel-change-password', function(e){
                e.preventDefault();
                showPage('profile-page');
            });
            
            // Password show/hide toggle (Material icon)
            $(document).on('click', '.password-toggle', function() {
                const $btn = $(this);
                const $input = $('#password');
                const isPassword = $input.attr('type') === 'password';
                $input.attr('type', isPassword ? 'text' : 'password');
                // swap Material icon text
                const $icon = $btn.find('.material-symbols-outlined');
                if ($icon.length) {
                    $icon.text(isPassword ? 'visibility_off' : 'visibility');
                }
                // update aria-label for accessibility
                $btn.attr('aria-label', isPassword ? 'Hide password' : 'Show password');
            });

            // Function to show a specific page and hide others
            function showPage(pageId) {
                $(".page").removeClass("active");
                $("#" + pageId).addClass("active");
                updateActiveNav(pageId);
            }
            
            // Function to auto calculate variation and update dropdown
            function autoCalculateVariation(item) {
                const currentQty = parseFloat(item.find('.current-qty').val()) || 0;
                const previousQty = parseFloat(item.find('.previous-qty').val()) || 0;
                const reasonDropdown = item.find('.variation-reason');
                
                // Only enable if both values are entered
                if (currentQty > 0 && previousQty > 0) {
                    reasonDropdown.prop('disabled', false);
                    
                    // Clear previous options
                    reasonDropdown.empty().append('<option value="">Select reason</option>');
                    
                    if (currentQty > previousQty) {
                        // Add high variation reasons
                        highVariationReasons.forEach(reason => {
                            reasonDropdown.append(`<option value="${reason.code}">${reason.code} - ${reason.text}</option>`);
                        });
                    } else if (currentQty < previousQty) {
                        // Add low variation reasons
                        lowVariationReasons.forEach(reason => {
                            reasonDropdown.append(`<option value="${reason.code}">${reason.code} - ${reason.text}</option>`);
                        });
                    } else {
                        // Add a disabled option
                        reasonDropdown.append('<option value="" disabled>No variation to report</option>');
                    }
                } else {
                    reasonDropdown.empty().append('<option value="">Enter both quantities to enable</option>').prop('disabled', true);
                }
            }
            
            // HS handlers: map HS Code to Product Name
            function wireHsHandlers(scope) {
                const $scope = scope || $(document);
                $scope.find('.hs-code').off('input change').on('input change', function() {
                    const code = $(this).val().trim();
                    const desc = hsCodeToDesc[code] || '';
                    $(this).closest('.form-columns').find('.product-name').val(desc);
                });
            }
            
            // Highlight active menu item
            function updateActiveNav(pageId) {
                $("nav a").removeClass("nav-active");
                switch(pageId) {
                    case 'landing-page':
                        $("#nav-landing").addClass("nav-active");
                        break;
                    case 'profile-page':
                        $("#nav-profile").addClass("nav-active");
                        break;
                    case 'production-page':
                        $("#nav-production").addClass("nav-active");
                        break;
                    case 'history-page':
                        $("#nav-history").addClass("nav-active");
                        break;
                    case 'login-page':
                        $("#nav-logout").addClass("nav-active");
                        break;
                }
                // Hide nav on login page, show it otherwise
                if (pageId === 'login-page') {
                    $("nav").hide();
                } else {
                    $("nav").show();
                }
            }
            
            // Set initial nav state
            updateActiveNav('login-page');
        });
    </script>
</body>
</html>